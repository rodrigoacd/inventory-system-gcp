{% extends "base.html" %}

{% block title %}Productos - Sistema de Inventario{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="bi bi-grid"></i> Lista de Productos</h2>
    </div>
    <div class="col text-end">
        <a href="{{ url_for('add_product') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> Agregar Producto
        </a>
    </div>
</div>

<div class="row mb-4" id="stats">
    <div class="col-md-3">
        <div class="card text-white bg-info">
            <div class="card-body">
                <h5 class="card-title">Total Productos</h5>
                <h2 class="card-text" id="total-products">-</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-success">
            <div class="card-body">
                <h5 class="card-title">Total Items</h5>
                <h2 class="card-text" id="total-items">-</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-primary">
            <div class="card-body">
                <h5 class="card-title">Valor Total</h5>
                <h2 class="card-text" id="total-value">$-</h2>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning">
            <div class="card-body">
                <h5 class="card-title">Stock Bajo</h5>
                <h2 class="card-text" id="low-stock">-</h2>
            </div>
        </div>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>Imagen</th>
                <th>Nombre</th>
                <th>SKU</th>
                <th>Categoría</th>
                <th>Cantidad</th>
                <th>Precio</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for product in products %}
            <tr>
                <td>
                    {% if product.image_url %}
                        <img src="{{ product.image_url }}" alt="{{ product.name }}" style="width: 50px; height: 50px; object-fit: cover;">
                    {% else %}
                        <i class="bi bi-image" style="font-size: 50px;"></i>
                    {% endif %}
                </td>
                <td>{{ product.name }}</td>
                <td><code>{{ product.sku }}</code></td>
                <td><span class="badge bg-secondary">{{ product.category or 'Sin categoría' }}</span></td>
                <td>
                    <span class="badge {% if product.quantity < 10 %}bg-danger{% elif product.quantity < 50 %}bg-warning{% else %}bg-success{% endif %}">
                        {{ product.quantity }}
                    </span>
                </td>
                <td>${{ "%.2f"|format(product.price) }}</td>
                <td>
                    <a href="{{ url_for('product_detail', product_id=product.id) }}" class="btn btn-sm btn-info">
                        <i class="bi bi-eye"></i> Ver
                    </a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" class="text-center">No hay productos registrados</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
